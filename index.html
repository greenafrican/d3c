<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
<script type="text/javascript" src="dist/moment.js"></script>
<script type="text/javascript" src="dist/calendar.js"></script>
<script type="text/javascript" src="dist/d3.min.js"></script>
<script type="text/javascript" src="dist/c3.js"></script>
<script type="text/javascript" src="dist/d3c.js"></script>

<link href="dist/c3.min.css" rel="stylesheet" type="text/css">

<script>
    var d3cTable, d3cChart;
    $(document).ready(function () {
        d3cTable = d3c.table({
            bindto: "#d3c-table",
            columns: [
                {
                    title: "Name",
                    key: 'name',
                    width: "15%",
                    type: "cell",
                    format: "text"
                },
                {
                    title: "Latest",
                    key: 'latest',
                    width: "40%",
                    type: "chart-bar",
                    format: "number",
                    chart: {
                        zeroBased: true,
                        colorFrom: "chart_change"
                    }
                },
                {
                    title: "Previous",
                    key: 'previous',
                    width: "10%",
                    type: "cell",
                    format: "number"
                },
                {
                    title: "Change",
                    key: 'chart_change',
                    width: "10%",
                    type: "highlight",
                    format: "percent"
                },
                {
                    title: "Spark",
                    key: 'chart_spark',
                    width: "10%",
                    type: "chart-spark",
                    format: "number",
                    chart: {
                        keys: {
                            x: 'date'
                        }
                    }
                }],
            data: [],
            chart: {
                bindto: '#d3c-chart',
                data: {
                    columns: [],
                    x: 'date',
                    type: 'line'
                },
                axis: {
                    x: {
                        type: 'timeseries',
                        tick: {
                            format: '%Y-%m-%d',
                            count: 5
                        }
                    },
                    y: {
                        tick: {
                            format: d3.format(".3s"),
                            count: 5
                        }
                    }
                }
            }
        });

        d3cTable.updateRow({
            'name': 'cows',
            'latest': 500000.00,
            'chart_change': -0.0581,
            'chart_spark': 'series',
            'series': [
                {"date": "2016-04-06", "cows": 1},
                {"date": "2016-04-07", "cows": 2},
                {"date": "2016-04-08", "cows": 3},
                {"date": "2016-04-09", "cows": 2},
                {"date": "2016-04-10", "cows": 1},
                {"date": "2016-04-11", "cows": 4}
            ]
        });
        d3cTable.updateRow({
            'name': 'ducks',
            'latest': 2500.00,
            'previous': 2465.00,
            'chart_change': 0.0375,
            'chart_spark': 'series',
            'series': [
                {"date": "2016-04-06", "ducks": 4},
                {"date": "2016-04-07", "ducks": 3},
                {"date": "2016-04-08", "ducks": 2},
                {"date": "2016-04-09", "ducks": 3},
                {"date": "2016-04-10", "ducks": 1},
                {"date": "2016-04-11", "ducks": 1}
            ]
        });

        setTimeout(function () {
            d3cTable.updateRow({
                'name': 'pigs',
                'latest': 108000,
                'previous': 100000,
                'chart_change': 0.08,
                'chart_spark': 'series',
                'series': [
                    {"date": "2016-04-06", "pigs": 1},
                    {"date": "2016-04-07", "pigs": 1},
                    {"date": "2016-04-08", "pigs": 2},
                    {"date": "2016-04-09", "pigs": 2},
                    {"date": "2016-04-10", "pigs": 4},
                    {"date": "2016-04-11", "pigs": 3}
                ]
            });

        }, 3500);

        window.addEventListener('resize', function (event) {
            d3cTable.redraw();
        });
    })
    ;
</script>

<div class="container">
    <div class="row">
        <div class="twelve columns">
            <div id="d3c-chart"></div>
        </div>
    </div>
    <div class="row">
        <div class="twelve columns">
            <div id="d3c-table"></div>
        </div>
    </div>
</div>

<style>
    body {
        font-family: Whitney, "Helvetica Neue", Helvetica, Arial, SansSerif;
    }

    .d3c-cell-dev {
        padding: 5px 12px 0 0;
    }

    #d3c-table table {
        width: 100%;
        border-collapse: collapse;
    }

    #d3c-table table,
    #d3c-table tr,
    #d3c-table th {
        margin: 0;
        border: 0;
        padding: 0;
    }

    #d3c-table td {
        margin: 0;
        padding: 8px;
        border: 0;
    }

    .d3c-chart-label-neg-high,
    .d3c-chart-label-pos-high {
        fill: #fff;
    }

    .d3c-chart-label-neg-low,
    .d3c-chart-label-pos-low {
        fill: #000;
    }

    .d3c-table-row-active {
        background-color: #e5f5fb;
    }

</style>
