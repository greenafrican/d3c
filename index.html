<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
<script type="text/javascript" src="dist/moment.js"></script>
<script type="text/javascript" src="dist/calendar.js"></script>
<script type="text/javascript" src="dist/d3.min.js"></script>
<script type="text/javascript" src="dist/c3.js"></script>
<script type="text/javascript" src="dist/d3c.js"></script>

<link href="dist/c3.min.css" rel="stylesheet" type="text/css">

<script>
    var d3cTable, d3cChart;
    $(document).ready(function () {
        d3cTable = d3c.table({
            bindto: "#d3c-table",
            columns: [
                {
                    title: "Name",
                    key: 'name',
                    width: "15%",
                    type: "cell",
                    format: "text"
                },
                {
                    title: "Latest",
                    key: 'latest',
                    width: "40%",
                    type: "chart",
                    format: "number",
                    chart: {
                        zeroBased: true,
                        colorFrom: "chart_change"
                    }
                },
                {
                    title: "Previous",
                    key: 'previous',
                    width: "15%",
                    type: "cell",
                    format: "number"
                },
                {
                    title: "Change",
                    key: 'chart_change',
                    width: "15%",
                    type: "highlight",
                    format: "percent"
                }],
            data: [
                {
                    'name': 'Cows',
                    'latest': 500000.00,
                    'previous': 565000.00,
                    'chart_change': -0.0581,
                    'series': [
                        {
                            "date": "2016-04-06",
                            "latest": "2587000",
                            "previous": "2590587"
                        }, {"date": "2016-04-07", "latest": "2586129", "previous": "2588963"}, {
                            "date": "2016-04-08",
                            "latest": "2586149",
                            "previous": "2588555"
                        }, {"date": "2016-04-09", "latest": "2586902", "previous": "2587207"}, {
                            "date": "2016-04-10",
                            "latest": "2587642",
                            "previous": "2586522"
                        }, {"date": "2016-04-11", "latest": "2590781", "previous": "2586768"}
                    ]
                },
                {
                    'name': 'Donkeys',
                    'latest': 2500.00,
                    'previous': 2465.00,
                    'chart_change': 0.0375,
                    'series': [
                        {
                            "date": "2016-04-06",
                            "latest": "2587000",
                            "previous": "2590587"
                        }, {"date": "2016-04-07", "latest": "2586129", "previous": "2588963"}, {
                            "date": "2016-04-08",
                            "latest": "2586149",
                            "previous": "2588555"
                        }, {"date": "2016-04-09", "latest": "2586902", "previous": "2587207"}, {
                            "date": "2016-04-10",
                            "latest": "2587642",
                            "previous": "2586522"
                        }, {"date": "2016-04-11", "latest": "2590781", "previous": "2586768"}
                    ]
                },
                {
                    'name': 'Pigs',
                    'latest': 102000,
                    'previous': 10000,
                    'chart_change': 0.005
                }],
            chart: {
                bindto: '#d3c-chart',
                data: {
                    json: [],
                    names: {
                        'previous': 'Previous',
                        'latest': 'Latest'
                    },
                    keys: {
                        x: 'date',
                        value: ['latest', 'previous']
                    },
                    type: 'line',
                    types: {
                        'previous': 'area'
                    },
                    classes: {
                        'previous': 'd3c-previous'
                    },
                    colors: {
                        'previous': '#e5e5e5',
                        'latest': '#64bc52'
                    }
                },
                area: {
                    zerobased: false
                },
                axis: {
                    x: {
                        type: 'timeseries',
                        tick: {
                            format: '%Y-%m-%d',
                            count: 5
                        }
                    },
                    y: {
                        tick: {
                            format: d3.format(".3s"),
                            count: 5
                        }
                    }
                },
            }
        });

        setTimeout(function () {
            d3cTable.updateRow({
                'name': 'Pigs',
                'latest': 108000,
                'previous': 100000,
                'difference': 8000,
                'chart_change': 0.08
            });

        }, 3500);

        window.addEventListener('resize', function (event) {
            d3cTable.redraw();
        });
    })
    ;
</script>

<div class="container">
    <div class="row">
        <div class="twelve columns">
            <div id="d3c-chart"></div>
        </div>
    </div>
    <div class="row">
        <div class="twelve columns">
            <div id="d3c-table"></div>
        </div>
    </div>
</div>

<style>
    body {
        font-family: Whitney, "Helvetica Neue", Helvetica, Arial, SansSerif;
    }

    .d3c-cell-dev {
        padding: 5px 12px 0 0;
    }

    #d3c-table table {
        width: 100%;
    }

    .d3c-chart-label-neg-high,
    .d3c-chart-label-pos-high {
        fill: #fff;
    }

    .d3c-chart-label-neg-low,
    .d3c-chart-label-pos-low {
        fill: #000;
    }

</style>
