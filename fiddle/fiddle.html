<!-- Load c3.css -->
<link href="css/c3.min.css" rel="stylesheet" type="text/css">

<!-- Load d3.js and c3.js -->
<script src="js/d3.min.js" charset="utf-8"></script>
<script src="js/c3.min.js"></script>

<div id="chart"></div>

<div class="key-colors">
    <div style="background-color:#ce472e"></div>
    <div style="background-color:#f05336"></div>
    <div style="background-color:#faa224"></div>
    <div style="background-color:#ffd73e"></div>
    <div style="background-color:#efe3be"></div>
    <div style="background-color:#c6e3bb"></div>
    <div style="background-color:#a3d393"></div>
    <div style="background-color:#64bc52"></div>
    <div style="background-color:#0099dc"></div>
</div>

<style>
    .c3-target-d3c-previous .c3-lines,
    .c3-target-d3c-previous .c3-circles {
        display: none;
    }
    .c3-target-d3c-previous .c3-area {
        fill: rgba(0,0,0,0.2) !important;
    }
    .d3c-tooltip td {
        background-color: #fff;
        font-family: sans-serif;
        font-size: 10px;
        padding: 10px;
        text-align: left;
    }
    .d3c-tooltip table {
        border-collapse: collapse;
    }

    .d3c-tooltip table, .d3c-tooltip th, .d3c-tooltip td {
        border: 1px solid black;
    }

</style>

<script>
    var arr = [[new Date("2015-05-20"), 2864141, 1071879, 272365],
        [new Date("2015-05-21"), 2879511, 1072624, 274013],
        [new Date("2015-05-22"), 2899292, 1084117, 271333],
        [new Date("2015-05-23"), 2892752, 1090554, 211014],
        [new Date("2015-05-24"), 2892491, 1085613, 207949],
        [new Date("2015-05-25"), 2883138, 1064853, 247603],
        [new Date("2015-05-26"), 2874745, 1052045, 255793],
        [new Date("2015-05-27"), 2864824, 1040781, 258832],
        [new Date("2015-05-28"), 2851689, 1022751, 250811],
        [new Date("2015-05-29"), 2837905, 998520, 237308],
        [new Date("2015-05-30"), 2825482, 991227, 192508],
        [new Date("2015-05-31"), 2812184, 988876, 200740],
        [new Date("2015-06-01"), 2812788, 992154, 264881],
        [new Date("2015-06-02"), 2807349, 994751, 258311],
        [new Date("2015-06-03"), 2811187, 1005514, 270622],
        [new Date("2015-06-04"), 2803982, 1011254, 254911],
        [new Date("2015-06-05"), 2798008, 1017826, 245658],
        [new Date("2015-06-06"), 2791073, 1022525, 197879],
        [new Date("2015-06-07"), 2776896, 1022769, 197301],
        [new Date("2015-06-08"), 2765755, 1015165, 255303],
        [new Date("2015-06-09"), 2754334, 1016343, 258252],
        [new Date("2015-06-10"), 2743939, 1000885, 252912],
        [new Date("2015-06-11"), 2729231, 1000597, 257054],
        [new Date("2015-06-12"), 2717265, 993704, 239797],
        [new Date("2015-06-13"), 2710104, 983270, 186405],
        [new Date("2015-06-14"), 2699894, 980098, 196297],
        [new Date("2015-06-15"), 2681411, 974853, 250108],
        [new Date("2015-06-16"), 2668799, 970542, 251689],
        [new Date("2015-06-17"), 2654492, 967528, 250163],
        [new Date("2015-06-18"), 2639811, 960426, 248526],
        [new Date("2015-06-19"), 2613588, 950127, 231786],
        [new Date("2015-06-20"), 2598478, 949690, 187136],
        [new Date("2015-06-21"), 2589981, 949843, 197440],
        [new Date("2015-06-22"), 2584298, 957484, 256953],
        [new Date("2015-06-23"), 2582960, 959030, 253019],
        [new Date("2015-06-24"), 2578393, 956833, 247202],
        [new Date("2015-06-25"), 2574161, 948614, 241576],
        [new Date("2015-06-26"), 2571016, 946845, 233067],
        [new Date("2015-06-27"), 2567203, 949719, 190159],
        [new Date("2015-06-28"), 2568150, 950235, 194671],
        [new Date("2015-06-29"), 2559488, 944921, 245677],
        [new Date("2015-06-30"), 2552866, 938447, 242496],
        [new Date("2015-07-01"), 2532695, 935332, 240207],
        [new Date("2015-07-02"), 2517096, 930699, 232256],
        [new Date("2015-07-03"), 2496959, 918986, 212627],
        [new Date("2015-07-04"), 2479500, 906746, 174976],
        [new Date("2015-07-05"), 2466546, 893438, 177163],
        [new Date("2015-07-06"), 2456832, 885431, 237363],
        [new Date("2015-07-07"), 2447220, 883085, 240006],
        [new Date("2015-07-08"), 2454925, 896888, 254406],
        [new Date("2015-07-09"), 2464765, 921724, 259488],
        [new Date("2015-07-10"), 2451632, 926781, 223904],
        [new Date("2015-07-11"), 2446311, 928232, 177778],
        [new Date("2015-07-12"), 2439910, 933110, 187145],
        [new Date("2015-07-13"), 2437424, 935703, 241069],
        [new Date("2015-07-14"), 2432031, 934957, 240232],
        [new Date("2015-07-15"), 2423891, 916770, 235936],
        [new Date("2015-07-16"), 2406652, 883500, 223667],
        [new Date("2015-07-17"), 2395860, 875176, 212430],
        [new Date("2015-07-18"), 2394072, 877269, 176782],
        [new Date("2015-07-19"), 2385516, 874202, 180835],
        [new Date("2015-07-20"), 2372175, 869737, 233719],
        [new Date("2015-07-21"), 2362793, 868226, 236987],
        [new Date("2015-07-22"), 2357974, 869141, 237014],
        [new Date("2015-07-23"), 2350414, 871706, 229728],
        [new Date("2015-07-24"), 2345683, 877002, 222919],
        [new Date("2015-07-25"), 2334192, 874748, 176872],
        [new Date("2015-07-26"), 2324935, 901991, 207737],
        [new Date("2015-07-27"), 2316619, 917809, 254001],
        [new Date("2015-07-28"), 2311429, 919345, 240888],
        [new Date("2015-07-29"), 2304397, 917346, 233264],
        [new Date("2015-07-30"), 2297982, 914165, 228228],
        [new Date("2015-07-31"), 2301202, 912240, 221578],
        [new Date("2015-08-01"), 2305188, 917451, 181335],
        [new Date("2015-08-02"), 2308930, 893431, 183273],
        [new Date("2015-08-03"), 2310085, 879938, 231353],
        [new Date("2015-08-04"), 2312691, 882398, 237903],
        [new Date("2015-08-05"), 2310708, 885653, 232940],
        [new Date("2015-08-06"), 2311358, 890295, 228998],
        [new Date("2015-08-07"), 2312368, 887350, 217447],
        [new Date("2015-08-08"), 2316423, 886465, 179631],
        [new Date("2015-08-09"), 2322392, 891458, 188039],
        [new Date("2015-08-10"), 2323003, 895090, 235807],
        [new Date("2015-08-11"), 2331136, 901022, 244709],
        [new Date("2015-08-12"), 2340343, 908611, 241102],
        [new Date("2015-08-13"), 2348231, 909810, 230769],
        [new Date("2015-08-14"), 2344295, 899460, 209535],
        [new Date("2015-08-15"), 2336775, 890561, 168805],
        [new Date("2015-08-16"), 2335077, 881969, 177020],
        [new Date("2015-08-17"), 2335071, 878515, 226761],
        [new Date("2015-08-18"), 2333095, 868256, 229491],
        [new Date("2015-08-19"), 2329350, 855850, 229539],
        [new Date("2015-08-20"), 2330554, 851399, 229754],
        [new Date("2015-08-21"), 2326314, 856476, 217517],
        [new Date("2015-08-22"), 2326079, 859828, 175353],
        [new Date("2015-08-23"), 2296324, 858756, 180998],
        [new Date("2015-08-24"), 2283629, 865572, 238634],
        [new Date("2015-08-25"), 2282754, 872338, 240005],
        [new Date("2015-08-26"), 2289778, 882471, 239753],
        [new Date("2015-08-27"), 2299333, 890622, 241055],
        [new Date("2015-08-28"), 2300065, 896440, 227365],
        [new Date("2015-08-29"), 2297211, 898831, 180955],
        [new Date("2015-08-30"), 2298933, 908155, 193020],
        [new Date("2015-08-31"), 2309727, 923170, 255877],
        [new Date("2015-09-01"), 2317834, 938740, 261585],
        [new Date("2015-09-02"), 2328283, 954811, 259438],
        [new Date("2015-09-03"), 2330760, 960882, 252955],
        [new Date("2015-09-04"), 2326147, 989665, 258821],
        [new Date("2015-09-05"), 2322219, 1008066, 204919],
        [new Date("2015-09-06"), 2317421, 1012509, 203365],
        [new Date("2015-09-07"), 2320680, 1010838, 235729],
        [new Date("2015-09-08"), 2327007, 1018875, 260470],
        [new Date("2015-09-09"), 2329894, 1019695, 253099],
        [new Date("2015-09-10"), 2336839, 1016973, 250671],
        [new Date("2015-09-11"), 2350135, 994217, 239477],
        [new Date("2015-09-12"), 2361362, 978679, 189761],
        [new Date("2015-09-13"), 2373680, 975973, 204076],
        [new Date("2015-09-14"), 2391614, 992507, 265631],
        [new Date("2015-09-15"), 2401158, 990239, 257162],
        [new Date("2015-09-16"), 2414805, 996334, 257218],
        [new Date("2015-09-17"), 2426973, 998470, 250983],
        [new Date("2015-09-18"), 2438519, 999501, 240053],
        [new Date("2015-09-19"), 2442233, 992016, 180707],
        [new Date("2015-09-20"), 2446044, 980514, 192759],
        [new Date("2015-09-21"), 2453363, 972850, 258851],
        [new Date("2015-09-22"), 2460976, 974234, 258280],
        [new Date("2015-09-23"), 2469420, 971605, 252822],
        [new Date("2015-09-24"), 2469491, 963906, 240627],
        [new Date("2015-09-25"), 2471838, 958112, 233073],
        [new Date("2015-09-26"), 2474969, 958161, 179051],
        [new Date("2015-09-27"), 2478110, 957884, 194127],
        [new Date("2015-09-28"), 2474955, 954808, 256644],
        [new Date("2015-09-29"), 2470992, 951459, 255624],
        [new Date("2015-09-30"), 2468478, 950848, 253220],
        [new Date("2015-10-01"), 2491290, 985154, 280282],
        [new Date("2015-10-02"), 2531142, 1056829, 327625],
        [new Date("2015-10-03"), 2527394, 1081262, 248133],
        [new Date("2015-10-04"), 2530114, 1101910, 265575],
        [new Date("2015-10-05"), 2558243, 1136768, 364561],
        [new Date("2015-10-06"), 2574768, 1161972, 358698],
        [new Date("2015-10-07"), 2592019, 1179844, 354708],
        [new Date("2015-10-08"), 2602351, 1190289, 346461],
        [new Date("2015-10-09"), 2607055, 1186526, 326549],
        [new Date("2015-10-10"), 2603008, 1184576, 244606],
        [new Date("2015-10-11"), 2601340, 1184881, 261464],
        [new Date("2015-10-12"), 2600674, 1178940, 344389],
        [new Date("2015-10-13"), 2611501, 1181902, 359123],
        [new Date("2015-10-14"), 2618236, 1185098, 354591],
        [new Date("2015-10-15"), 2623951, 1188569, 348968],
        [new Date("2015-10-16"), 2625841, 1190606, 329930],
        [new Date("2015-10-17"), 2628407, 1193537, 246816],
        [new Date("2015-10-18"), 2635123, 1195821, 269095],
        [new Date("2015-10-19"), 2645438, 1205469, 366262],
        [new Date("2015-10-20"), 2654522, 1207658, 361062],
        [new Date("2015-10-21"), 2661113, 1208877, 358923],
        [new Date("2015-10-22"), 2667723, 1204565, 346205],
        [new Date("2015-10-23"), 2670525, 1200317, 327791],
        [new Date("2015-10-24"), 2673294, 1201314, 248019],
        [new Date("2015-10-25"), 2677704, 1199477, 263544],
        [new Date("2015-10-26"), 2688370, 1200264, 362122],
        [new Date("2015-10-27"), 2701157, 1206608, 364307],
        [new Date("2015-10-28"), 2710056, 1208266, 357229],
        [new Date("2015-10-29"), 2712723, 1205311, 342634],
        [new Date("2015-10-30"), 2709734, 1196371, 321789],
        [new Date("2015-10-31"), 2711178, 1194755, 249761],
        [new Date("2015-11-01"), 2715352, 1197295, 264425],
        [new Date("2015-11-02"), 2720333, 1203509, 364553],
        [new Date("2015-11-03"), 2721907, 1202039, 357730],
        [new Date("2015-11-04"), 2724981, 1203772, 359351],
        [new Date("2015-11-05"), 2727236, 1206474, 349050],
        [new Date("2015-11-06"), 2727123, 1208736, 327613],
        [new Date("2015-11-07"), 2729235, 1207685, 248011],
        [new Date("2015-11-08"), 2726760, 1204370, 262694],
        [new Date("2015-11-09"), 2728507, 1198630, 360299],
        [new Date("2015-11-10"), 2727079, 1196251, 353583],
        [new Date("2015-11-11"), 2723324, 1188265, 343851],
        [new Date("2015-11-12"), 2717157, 1181266, 338861],
        [new Date("2015-11-13"), 2710158, 1176537, 319834],
        [new Date("2015-11-14"), 2707594, 1173093, 242472],
        [new Date("2015-11-15"), 2703136, 1171089, 259568],
        [new Date("2015-11-16"), 2698958, 1168979, 355017],
        [new Date("2015-11-17"), 2696246, 1170491, 353616],
        [new Date("2015-11-18"), 2694311, 1172114, 349682],
        [new Date("2015-11-19"), 2692664, 1171681, 338977],
        [new Date("2015-11-20"), 2687222, 1171157, 320759],
        [new Date("2015-11-21"), 2684024, 1173220, 244192],
        [new Date("2015-11-22"), 2680673, 1171260, 257966],
        [new Date("2015-11-23"), 2678316, 1168464, 351087],
        [new Date("2015-11-24"), 2672906, 1164699, 345216],
        [new Date("2015-11-25"), 2665632, 1153888, 331371],
        [new Date("2015-11-26"), 2655492, 1132036, 295202],
        [new Date("2015-11-27"), 2646530, 1109720, 279063],
        [new Date("2015-11-28"), 2641927, 1105223, 233140],
        [new Date("2015-11-29"), 2635290, 1103620, 252906],
        [new Date("2015-11-30"), 2627568, 1106047, 352744],
        [new Date("2015-12-01"), 2624615, 1113953, 357353],
        [new Date("2015-12-02"), 2618798, 1122540, 348194],
        [new Date("2015-12-03"), 2612525, 1140267, 338175],
        [new Date("2015-12-04"), 2604702, 1147249, 297998],
        [new Date("2015-12-05"), 2602028, 1149159, 239491],
        [new Date("2015-12-06"), 2597219, 1145100, 249959],
        [new Date("2015-12-07"), 2591310, 1135226, 338507],
        [new Date("2015-12-08"), 2587439, 1124950, 337102],
        [new Date("2015-12-09"), 2582349, 1117499, 335123],
        [new Date("2015-12-10"), 2579130, 1109893, 326969],
        [new Date("2015-12-11"), 2573073, 1107495, 300728],
        [new Date("2015-12-12"), 2570446, 1102773, 227524],
        [new Date("2015-12-13"), 2564723, 1098749, 240584],
        [new Date("2015-12-14"), 2556755, 1090784, 323123],
        [new Date("2015-12-15"), 2547962, 1082231, 324246],
        [new Date("2015-12-16"), 2536069, 1068654, 313784],
        [new Date("2015-12-17"), 2522640, 1053028, 302816],
        [new Date("2015-12-18"), 2510668, 1041766, 285144],
        [new Date("2015-12-19"), 2503338, 1035479, 217225],
        [new Date("2015-12-20"), 2492117, 1022946, 219882],
        [new Date("2015-12-21"), 2474371, 1005059, 289477],
        [new Date("2015-12-22"), 2457721, 985246, 286629],
        [new Date("2015-12-23"), 2439533, 961148, 270432],
        [new Date("2015-12-24"), 2420642, 924599, 230697],
        [new Date("2015-12-25"), 2399212, 876754, 179653],
        [new Date("2015-12-26"), 2390876, 867277, 190068],
        [new Date("2015-12-27"), 2380960, 862425, 205281],
        [new Date("2015-12-28"), 2362062, 851703, 266384],
        [new Date("2015-12-29"), 2343204, 844487, 272057],
        [new Date("2015-12-30"), 2327732, 851890, 285449],
        [new Date("2015-12-31"), 2308813, 872360, 270694],
        [new Date("2016-01-01"), 2299673, 903190, 237999],
        [new Date("2016-01-02"), 2309322, 935163, 250813],
        [new Date("2016-01-03"), 2317482, 965064, 262265],
        [new Date("2016-01-04"), 2320374, 1011141, 339026],
        [new Date("2016-01-05"), 2321659, 1047864, 337137],
        [new Date("2016-01-06"), 2322820, 1071348, 332475],
        [new Date("2016-01-07"), 2323766, 1098583, 333812],
        [new Date("2016-01-08"), 2328884, 1130610, 322941],
        [new Date("2016-01-09"), 2336536, 1130058, 253915],
        [new Date("2016-01-10"), 2344805, 1132272, 269368],
        [new Date("2016-01-11"), 2354412, 1141563, 353665],
        [new Date("2016-01-12"), 2361864, 1148485, 346285],
        [new Date("2016-01-13"), 2373231, 1157241, 346848],
        [new Date("2016-01-14"), 2387148, 1163584, 342939],
        [new Date("2016-01-15"), 2399677, 1166278, 329280],
        [new Date("2016-01-16"), 2412629, 1169751, 257023],
        [new Date("2016-01-17"), 2429269, 1171510, 270029],
        [new Date("2016-01-18"), 2452977, 1177011, 355948],
        [new Date("2016-01-19"), 2471583, 1182146, 354628],
        [new Date("2016-01-20"), 2490694, 1181123, 349636],
        [new Date("2016-01-21"), 2517304, 1178522, 342110],
        [new Date("2016-01-22"), 2546535, 1173796, 326516],
        [new Date("2016-01-23"), 2559796, 1172489, 259241],
        [new Date("2016-01-24"), 2572705, 1172286, 272539],
        [new Date("2016-01-25"), 2590729, 1170355, 358632],
        [new Date("2016-01-26"), 2605517, 1168198, 351547],
        [new Date("2016-01-27"), 2617038, 1170110, 353177],
        [new Date("2016-01-28"), 2633399, 1175809, 349856],
        [new Date("2016-01-29"), 2648255, 1179483, 332523],
        [new Date("2016-01-30"), 2644941, 1180897, 257992],
        [new Date("2016-01-31"), 2643608, 1183562, 275971],
        [new Date("2016-02-01"), 2647290, 1192803, 373145],
        [new Date("2016-02-02"), 2651111, 1202702, 366034],
        [new Date("2016-02-03"), 2655410, 1208615, 363769],
        [new Date("2016-02-04"), 2656620, 1208689, 352898],
        [new Date("2016-02-05"), 2654525, 1207293, 334380],
        [new Date("2016-02-06"), 2653271, 1206994, 256876],
        [new Date("2016-02-07"), 2650197, 1202824, 269293],
        [new Date("2016-02-08"), 2646834, 1193901, 351986],
        [new Date("2016-02-09"), 2647402, 1190935, 355774],
        [new Date("2016-02-10"), 2645490, 1187139, 355309],
        [new Date("2016-02-11"), 2643512, 1184591, 348520],
        [new Date("2016-02-12"), 2638473, 1180575, 331289],
        [new Date("2016-02-13"), 2634601, 1180119, 257095],
        [new Date("2016-02-14"), 2630182, 1179027, 270495],
        [new Date("2016-02-15"), 2623735, 1180982, 351935],
        [new Date("2016-02-16"), 2622918, 1182235, 356689],
        [new Date("2016-02-17"), 2625838, 1184000, 357772],
        [new Date("2016-02-18"), 2628138, 1183561, 349284],
        [new Date("2016-02-19"), 2630267, 1183537, 333710],
        [new Date("2016-02-20"), 2632044, 1186583, 260487],
        [new Date("2016-02-21"), 2632401, 1189309, 274081],
        [new Date("2016-02-22"), 2635637, 1197700, 367823],
        [new Date("2016-02-23"), 2638737, 1201621, 362523],
        [new Date("2016-02-24"), 2641169, 1202030, 359662],
        [new Date("2016-02-25"), 2640153, 1201513, 350205],
        [new Date("2016-02-26"), 2636837, 1197804, 330246],
        [new Date("2016-02-27"), 2635703, 1195782, 254347],
        [new Date("2016-02-28"), 2634381, 1195162, 271425],
        [new Date("2016-02-29"), 2633256, 1195237, 366867],
        [new Date("2016-03-01"), 2634032, 1199791, 365817],
        [new Date("2016-03-02"), 2634622, 1201199, 360187],
        [new Date("2016-03-03"), 2635924, 1202221, 353233],
        [new Date("2016-03-04"), 2635807, 1202924, 335232],
        [new Date("2016-03-05"), 2635387, 1203220, 255170],
        [new Date("2016-03-06"), 2635678, 1201683, 269907],
        [new Date("2016-03-07"), 2639570, 1200289, 365290],
        [new Date("2016-03-08"), 2641797, 1199688, 363992],
        [new Date("2016-03-09"), 2641889, 1196280, 355296],
        [new Date("2016-03-10"), 2641341, 1192171, 347649],
        [new Date("2016-03-11"), 2641470, 1188492, 330581],
        [new Date("2016-03-12"), 2641484, 1187203, 252025],
        [new Date("2016-03-13"), 2641158, 1184094, 265396],
        [new Date("2016-03-14"), 2642037, 1180486, 358137]];
    var data = [];

    for (var i = 0; i < arr.length; i++) {
        data.push({
            'date': arr[i][0],
            '28d': arr[i][1],
            '7d': arr[i][2],
            '1d': arr[i][3]
        })
    }

    for (i = data.length - 1; i > 27; i--) {
        data[i]['p28d'] = data[i - 28]['28d'];
        data[i]['p7d'] = data[i - 7]['7d'];
        data[i]['p1d'] = data[i - 1]['1d'];
    }

    data = data.slice(Math.max(arr.length - 28, 1));

    var chart = c3.generate({
        zoom: true,
        bindto: '#chart',
        data: {
            json: data,
            names: {
                'p28d': 'Previous Period',
                '28d': 'Current Period'
            },
            keys: {
                x: 'date',
                value: ['28d', 'p28d']
            },
            type: 'line',
            types: {
                'p28d': 'area'
            },
            classes: {
                'p28d': 'd3c-previous'
            },
            colors: {
                'p28d': '#e5e5e5',
                '28d': '#0099dc'
            }
        },
        area: {
            zerobased: false
        },
        axis: {
            x: {
                type: 'timeseries',
                tick: {
                    format: '%Y-%m-%d'
                }
            },
            y: {
                tick: {
                    format: d3.format("$,")
                }
            }
        },
        tooltip: {
            contents: function (d, defaultTitleFormat, defaultValueFormat, color) {
                var per = (d[0].value - d[1].value) / d[1].value;
                return "<div class='d3c-tooltip'><table><tbody>" +
                        "<tr><td>" +
                        d3.time.format("%Y-%m-%d")(d[0].x) +
                        "</td><td>" +
                        d3.format(",")(d[0].value) + " " +
                        "</td><td rowspan='2'>" +
                        d3.format(".2%")(per) + "</td></tr>" +
                        "<tr><td>" +
                        d3.time.format("%Y-%m-%d")(d3.time.day.offset(d[1].x, -7)) +
                        "</td><td>" +
                        d3.format(",")(d[1].value) +
                        "</td></tr>" +
                        "</tbody></table></div>";
            }
        }
    });


</script>